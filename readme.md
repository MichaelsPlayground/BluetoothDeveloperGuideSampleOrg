# Bluetooth Developer guide sample

This app is oriented to Google's developer guide example code and allows to connect and chat 
with another Android device.

These are the steps for a successful Bluetooth communication

- step 1: check if the device has a Bluetooth sender/receiver chip
- step 2: grant the permissions that are needed to run the app
- step 3: check that Bluetooth is enabled on the device
- step 4: run the server to listen for incomming connection requests
- step 5: find devices nearby and make your device discoverable by other devices
- step 6: list found devices
- step 7: connect to a found device
- step 8: if the two devices were not coupled before ask the user to allow a connection
- step 9: when the devices are coupled and connected allow both users to send messages

Step 4 is done using the information from the developer guide using an own DeviceListActivity.

The UUID used for this app was generated by an online service: https://www.uuidgenerator.net/guid:
```plaintext
2f5624ab-a8e8-4dd3-801a-262ad46dcee7
```

The main source of this app is the developer guide found here: https://developer.android.com/guide/topics/connectivity/bluetooth

A (a little bit more complicated but better) sample app is available on Github:

https://github.com/android/connectivity-samples/tree/master/BluetoothChat

Set up Bluetooth: https://developer.android.com/guide/topics/connectivity/bluetooth/setup#java

Find Bluetooth devices: https://developer.android.com/guide/topics/connectivity/bluetooth/find-bluetooth-devices

Connect Bluetooth devices: https://developer.android.com/guide/topics/connectivity/bluetooth/connect-bluetooth-devices

Transfer Bluetooth data: https://developer.android.com/guide/topics/connectivity/bluetooth/transfer-data

Bluetooth permissions: https://developer.android.com/guide/topics/connectivity/bluetooth/permissions

Bluetooth profiles: https://developer.android.com/guide/topics/connectivity/bluetooth/profiles

Companion device pairing: https://developer.android.com/guide/topics/connectivity/companion-device-pairing

These permissions need to be set in the AndroidManifest.xml:
```plaintext
<!-- Min/target SDK versions (<uses-sdk>) managed by build.gradle -->
    <!-- Request legacy Bluetooth permissions on older devices. -->
    <uses-permission
        android:name="android.permission.BLUETOOTH"
        android:maxSdkVersion="30" />
    <uses-permission
        android:name="android.permission.BLUETOOTH_ADMIN"
        android:maxSdkVersion="30" />
    <!--
 Needed only if your app looks for Bluetooth devices.
         If your app doesn't use Bluetooth scan results to derive physical
         location information, you can strongly assert that your app
         doesn't derive physical location.
    -->
    <uses-permission
        android:name="android.permission.BLUETOOTH_SCAN"
        android:usesPermissionFlags="neverForLocation"
        tools:targetApi="s" />
    <!--
 Needed only if your app makes the device discoverable to Bluetooth
         devices.
    -->
    <uses-permission android:name="android.permission.BLUETOOTH_ADVERTISE" />
    <!--
 Needed only if your app communicates with already-paired Bluetooth
         devices.
    -->
    <uses-permission android:name="android.permission.BLUETOOTH_CONNECT" /> <!-- Needed only if your app uses Bluetooth scan results to derive physical location. -->
    <uses-permission
        android:name="android.permission.ACCESS_FINE_LOCATION"
        tools:ignore="CoarseFineLocation" />
```

Please note - this app just want to show how to run a Bluetooth chat with minimal effort. The app 
does not have a real good exception management, e.g. when one device goes "offline" the other device 
won't get notified and can try to send messages but the other device will not recognize these 
messages.

To get a connection it is important that both devices are discoverable but the scan/connectivity has 
to be done only from one of the two devices.

The app is developed with Java 11 and Android SDK 32, the target SDK is 32 so this app can be run 
on actual devices (SDK 32) with a minimum SDK of 23.
